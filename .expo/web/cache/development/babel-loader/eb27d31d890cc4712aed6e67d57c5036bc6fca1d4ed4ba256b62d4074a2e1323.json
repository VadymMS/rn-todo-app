{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _this = this,\n  _jsxFileName = \"/Users/vadymmykhailichenko/Desktop/vadym/projects/educational-projects/react-native/react-native-demo/src/context/todo/TodoState.js\";\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useReducer, useContext } from 'react';\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport { TodoContext } from \"./todoContext\";\nimport { todoReducer } from \"./todoReducer\";\nimport { ADD_TODO, HIDE_LOADER, REMOVE_TODO, SHOW_ERROR, SHOW_LOADER, UPDATE_TODO, CLEAR_ERROR, FETCH_TODOS } from \"../types\";\nimport { ScreenContext } from \"../screen/screenContext\";\nimport { Http } from \"../../http\";\nexport var TodoState = function TodoState(_ref) {\n  var children = _ref.children;\n  var initialState = {\n    todos: [],\n    loading: false,\n    error: null\n  };\n  var _useContext = useContext(ScreenContext),\n    changeScreen = _useContext.changeScreen;\n  var _useReducer = useReducer(todoReducer, initialState),\n    _useReducer2 = _slicedToArray(_useReducer, 2),\n    state = _useReducer2[0],\n    dispatch = _useReducer2[1];\n  var addTodo = function addTodo(title) {\n    var data;\n    return _regeneratorRuntime.async(function addTodo$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            clearError();\n            _context.prev = 1;\n            _context.next = 4;\n            return _regeneratorRuntime.awrap(Http.post('https://rn-todo-app-2f6a7-default-rtdb.firebaseio.com/todos.json', {\n              title: title\n            }));\n          case 4:\n            data = _context.sent;\n            dispatch({\n              type: ADD_TODO,\n              title: title,\n              id: data.name\n            });\n            _context.next = 11;\n            break;\n          case 8:\n            _context.prev = 8;\n            _context.t0 = _context[\"catch\"](1);\n            showError('Что-то пошло не так...');\n          case 11:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[1, 8]], Promise);\n  };\n  var removeTodo = function removeTodo(id) {\n    var todo = state.todos.find(function (t) {\n      return t.id === id;\n    });\n    Alert.alert('Удаление элемента', \"\\u0412\\u044B \\u0443\\u0432\\u0435\\u0440\\u0435\\u043D\\u044B, \\u0447\\u0442\\u043E \\u0445\\u043E\\u0442\\u0438\\u0442\\u0435 \\u0443\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\\"\" + todo.title + \"\\\"?\", [{\n      text: 'Отмена',\n      style: 'cancel'\n    }, {\n      text: 'Удалить',\n      style: 'destructive',\n      onPress: function onPress() {\n        return _regeneratorRuntime.async(function onPress$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                changeScreen(null);\n                _context2.prev = 1;\n                _context2.next = 4;\n                return _regeneratorRuntime.awrap(Http.delete(\"https://rn-todo-app-2f6a7-default-rtdb.firebaseio.com/todos/\" + id + \".json\"));\n              case 4:\n                dispatch({\n                  type: REMOVE_TODO,\n                  id: id\n                });\n                _context2.next = 10;\n                break;\n              case 7:\n                _context2.prev = 7;\n                _context2.t0 = _context2[\"catch\"](1);\n                showError('Что-то пошло не так...');\n              case 10:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, null, null, [[1, 7]], Promise);\n      }\n    }], {\n      cancelable: false\n    });\n  };\n  var fetchTodos = function fetchTodos() {\n    var data, todos;\n    return _regeneratorRuntime.async(function fetchTodos$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            showLoader();\n            clearError();\n            _context3.prev = 2;\n            _context3.next = 5;\n            return _regeneratorRuntime.awrap(Http.get('https://rn-todo-app-2f6a7-default-rtdb.firebaseio.com/todos.json'));\n          case 5:\n            _context3.t0 = _context3.sent;\n            if (_context3.t0) {\n              _context3.next = 8;\n              break;\n            }\n            _context3.t0 = [];\n          case 8:\n            data = _context3.t0;\n            todos = Object.keys(data).map(function (key) {\n              return _objectSpread(_objectSpread({}, data[key]), {}, {\n                id: key\n              });\n            });\n            dispatch({\n              type: FETCH_TODOS,\n              todos: todos\n            });\n            _context3.next = 16;\n            break;\n          case 13:\n            _context3.prev = 13;\n            _context3.t1 = _context3[\"catch\"](2);\n            showError('Что-то пошло не так...');\n          case 16:\n            _context3.prev = 16;\n            hideLoader();\n            return _context3.finish(16);\n          case 19:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, [[2, 13, 16, 19]], Promise);\n  };\n  var updateTodo = function updateTodo(id, title) {\n    return _regeneratorRuntime.async(function updateTodo$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            clearError();\n            _context4.prev = 1;\n            _context4.next = 4;\n            return _regeneratorRuntime.awrap(Http.patch(\"https://rn-todo-app-2f6a7-default-rtdb.firebaseio.com/todos/\" + id + \".json\"));\n          case 4:\n            dispatch({\n              type: UPDATE_TODO,\n              id: id,\n              title: title\n            });\n            _context4.next = 10;\n            break;\n          case 7:\n            _context4.prev = 7;\n            _context4.t0 = _context4[\"catch\"](1);\n            showError('Что-то пошло не так...');\n          case 10:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, null, null, [[1, 7]], Promise);\n  };\n  var showLoader = function showLoader() {\n    return dispatch({\n      type: SHOW_LOADER\n    });\n  };\n  var hideLoader = function hideLoader() {\n    return dispatch({\n      type: HIDE_LOADER\n    });\n  };\n  var showError = function showError(error) {\n    return dispatch({\n      type: SHOW_ERROR,\n      error: error\n    });\n  };\n  var clearError = function clearError() {\n    return dispatch({\n      type: CLEAR_ERROR\n    });\n  };\n  return React.createElement(TodoContext.Provider, {\n    value: {\n      todos: state.todos,\n      loading: state.loading,\n      error: state.error,\n      addTodo: addTodo,\n      removeTodo: removeTodo,\n      updateTodo: updateTodo,\n      fetchTodos: fetchTodos\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 9\n    }\n  }, children);\n};","map":{"version":3,"names":["React","useReducer","useContext","Alert","TodoContext","todoReducer","ADD_TODO","HIDE_LOADER","REMOVE_TODO","SHOW_ERROR","SHOW_LOADER","UPDATE_TODO","CLEAR_ERROR","FETCH_TODOS","ScreenContext","Http","TodoState","_ref","children","initialState","todos","loading","error","_useContext","changeScreen","_useReducer","_useReducer2","_slicedToArray","state","dispatch","addTodo","title","data","_regeneratorRuntime","async","addTodo$","_context","prev","next","clearError","awrap","post","sent","type","id","name","t0","showError","stop","Promise","removeTodo","todo","find","t","alert","text","style","onPress","onPress$","_context2","delete","cancelable","fetchTodos","fetchTodos$","_context3","showLoader","get","Object","keys","map","key","_objectSpread","t1","hideLoader","finish","updateTodo","updateTodo$","_context4","patch","createElement","Provider","value","__self","_this","__source","fileName","_jsxFileName","lineNumber","columnNumber"],"sources":["/Users/vadymmykhailichenko/Desktop/vadym/projects/educational-projects/react-native/react-native-demo/src/context/todo/TodoState.js"],"sourcesContent":["import React, {useReducer, useContext} from 'react';\nimport {Alert} from 'react-native';\nimport {TodoContext} from './todoContext';\nimport {todoReducer} from './todoReducer';\nimport {\n    ADD_TODO,\n    HIDE_LOADER,\n    REMOVE_TODO,\n    SHOW_ERROR,\n    SHOW_LOADER,\n    UPDATE_TODO,\n    CLEAR_ERROR,\n    FETCH_TODOS,\n} from '../types';\nimport {ScreenContext} from '../screen/screenContext';\nimport {Http} from '../../http';\n\nexport const TodoState = ({children}) => {\n    const initialState = {todos: [], loading: false, error: null};\n    const {changeScreen} = useContext(ScreenContext);\n    const [state, dispatch] = useReducer(todoReducer, initialState);\n\n    const addTodo = async title => {\n        clearError();\n        try {\n            const data = await Http.post('https://rn-todo-app-2f6a7-default-rtdb.firebaseio.com/todos.json', {title});\n            dispatch({type: ADD_TODO, title, id: data.name});\n        } catch (error) {\n            showError('Что-то пошло не так...');\n        }\n    };\n\n    const removeTodo = id => {\n        const todo = state.todos.find(t => t.id === id);\n        Alert.alert(\n            'Удаление элемента',\n            `Вы уверены, что хотите удалить \"${todo.title}\"?`,\n            [\n                {\n                    text: 'Отмена',\n                    style: 'cancel',\n                },\n                {\n                    text: 'Удалить',\n                    style: 'destructive',\n                    onPress: async () => {\n                        changeScreen(null);\n                        try {\n                            await Http.delete(`https://rn-todo-app-2f6a7-default-rtdb.firebaseio.com/todos/${id}.json`);\n                            dispatch({type: REMOVE_TODO, id});\n                        } catch (error) {\n                            showError('Что-то пошло не так...');\n                        }\n                    },\n                },\n            ],\n            {cancelable: false}\n        );\n    };\n\n    const fetchTodos = async () => {\n        showLoader();\n        clearError();\n        try {\n            const data = (await Http.get('https://rn-todo-app-2f6a7-default-rtdb.firebaseio.com/todos.json')) || [];\n            const todos = Object.keys(data).map(key => ({...data[key], id: key}));\n            dispatch({type: FETCH_TODOS, todos});\n        } catch (error) {\n            showError('Что-то пошло не так...');\n        } finally {\n            hideLoader();\n        }\n    };\n\n    const updateTodo = async (id, title) => {\n        clearError();\n        try {\n            await Http.patch(`https://rn-todo-app-2f6a7-default-rtdb.firebaseio.com/todos/${id}.json`);\n            dispatch({type: UPDATE_TODO, id, title});\n        } catch (error) {\n            showError('Что-то пошло не так...');\n        }\n    };\n\n    const showLoader = () => dispatch({type: SHOW_LOADER});\n\n    const hideLoader = () => dispatch({type: HIDE_LOADER});\n\n    const showError = error => dispatch({type: SHOW_ERROR, error});\n\n    const clearError = () => dispatch({type: CLEAR_ERROR});\n\n    return (\n        <TodoContext.Provider\n            value={{\n                todos: state.todos,\n                loading: state.loading,\n                error: state.error,\n                addTodo,\n                removeTodo,\n                updateTodo,\n                fetchTodos,\n            }}\n        >\n            {children}\n        </TodoContext.Provider>\n    );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}